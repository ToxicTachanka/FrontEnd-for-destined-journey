{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/zod_schema/utils.ts","src://tavern_helper_template/src/zod_schema/schema.ts","src://tavern_helper_template/src/zod_schema/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","/** 数值范围限制 */\nexport const clamp = (min, max) => (val) => _.clamp(val, min, max);\n/**\n * 范围限制数值 schema\n */\nexport const clampedNum = (defaultVal, min, max) => z.coerce.number().prefault(defaultVal).transform(clamp(min, max));\n// 基础物品描述 schema\nexport const BaseItemSchema = z.object({\n    品质: z.string(),\n    标签: z.string(),\n    效果: z.string(),\n    描述: z.string(),\n});\n// 技能 schema (扩展基础物品 + 类型/消耗)\nexport const SkillSchema = BaseItemSchema.extend({\n    类型: z.string(),\n    消耗: z.string(),\n}).transform(({ 品质, 类型, 消耗, 标签, 效果, 描述 }) => ({\n    品质,\n    类型,\n    消耗,\n    标签,\n    效果,\n    描述,\n}));\n// 装备 schema (扩展基础物品 + 位置)\nexport const EquipmentSchema = BaseItemSchema.extend({\n    位置: z.string(),\n});\n// 命定之人装备 schema (扩展基础物品 + 类型)\nexport const DestinedEquipmentSchema = BaseItemSchema.extend({\n    类型: z.string(),\n}).transform(({ 品质, 类型, 标签, 效果, 描述 }) => ({\n    品质,\n    类型,\n    标签,\n    效果,\n    描述,\n}));\n// 背包物品 schema (扩展命定装备 + 数量)\nexport const InventoryItemSchema = BaseItemSchema.extend({\n    数量: z.coerce.number().prefault(1),\n    类型: z.string(),\n}).transform(({ 品质, 数量, 类型, 标签, 效果, 描述 }) => ({\n    品质,\n    数量,\n    类型,\n    标签,\n    效果,\n    描述,\n}));\n// 基础属性 schema\nexport const BaseAttributeSchema = z.object({\n    力量: z.coerce.number(),\n    敏捷: z.coerce.number(),\n    体质: z.coerce.number(),\n    智力: z.coerce.number(),\n    精神: z.coerce.number(),\n});\n// 角色属性 schema (扩展基础属性 + 属性点)\nexport const CharacterAttributeSchema = BaseAttributeSchema.extend({\n    属性点: z.coerce.number(),\n});\n// 神国 schema\nexport const DivineRealmSchema = z.object({\n    名称: z.string().prefault(''),\n    描述: z.string().prefault(''),\n});\n// 登神长阶 schema\nexport const AscensionSchema = z.object({\n    是否开启: z.boolean().prefault(false),\n    要素: z.record(z.string(), z.string()).prefault({}),\n    权能: z.record(z.string(), z.string()).prefault({}),\n    法则: z.record(z.string(), z.string()).prefault({}),\n    神位: z.string().prefault(''),\n    神国: DivineRealmSchema.prefault({}),\n});\n// 任务 schema\nexport const QuestSchema = z.object({\n    简介: z.string(),\n    目标: z.string(),\n    奖励: z.string(),\n});\n","import { AscensionSchema, BaseAttributeSchema, CharacterAttributeSchema, clampedNum, DestinedEquipmentSchema, EquipmentSchema, InventoryItemSchema, QuestSchema, SkillSchema, } from './utils.ts';\nexport const Schema = z.object({\n    世界: z.object({ 时间: z.string(), 地点: z.string() }),\n    事件链: z.object({\n        开启: z.boolean().prefault(false),\n        结束: z.boolean().prefault(false),\n        琥珀事件: z.boolean().prefault(false),\n        标题: z.string(),\n        阶段: z.string(),\n        已完成事件: z.array(z.string()),\n    }),\n    任务列表: z.record(z.string(), QuestSchema),\n    角色: z\n        .object({\n        种族: z.string(),\n        身份: z.array(z.string()),\n        职业: z.array(z.string()),\n        生命层级: z.string().prefault('第一层级/普通层级'),\n        等级: clampedNum(1, 1, 25),\n        累计经验值: z.coerce.number(),\n        升级所需经验: z.coerce.number().prefault(23),\n        冒险者等级: z.string().prefault('未评级'),\n        生命值上限: z.coerce.number(),\n        生命值: z.coerce.number(),\n        法力值上限: z.coerce.number(),\n        法力值: z.coerce.number(),\n        体力值上限: z.coerce.number(),\n        体力值: z.coerce.number(),\n        属性: CharacterAttributeSchema,\n        技能列表: z.record(z.string(), SkillSchema),\n    })\n        .transform(data => ({\n        ...data,\n        升级所需经验: data.等级 >= 25 ? 'MAX' : data.升级所需经验,\n        生命值: _.clamp(data.生命值, 0, data.生命值上限),\n        法力值: _.clamp(data.法力值, 0, data.法力值上限),\n        体力值: _.clamp(data.体力值, 0, data.体力值上限),\n    })),\n    背包: z.record(z.string(), InventoryItemSchema),\n    货币: z.object({\n        金币: z.coerce\n            .number()\n            .prefault(0)\n            .transform(val => Math.floor(Math.max(val, 0))),\n        银币: z.coerce\n            .number()\n            .prefault(0)\n            .transform(val => Math.floor(Math.max(val, 0))),\n        铜币: z.coerce\n            .number()\n            .prefault(0)\n            .transform(val => Math.floor(val)),\n    }),\n    装备: z.object({\n        武器: z.record(z.string(), EquipmentSchema),\n        防具: z.record(z.string(), EquipmentSchema),\n        饰品: z.record(z.string(), EquipmentSchema),\n    }),\n    登神长阶: AscensionSchema,\n    命定系统: z.object({\n        命运点数: z.coerce.number().transform(val => Math.floor(Math.max(val, 0))),\n        命定之人: z.record(z.string(), z.object({\n            是否在场: z.boolean().prefault(true),\n            生命层级: z.string(),\n            等级: clampedNum(1, 1, 25),\n            种族: z.string(),\n            身份: z.array(z.string()),\n            职业: z.array(z.string()),\n            性格: z.string(),\n            喜爱: z.string(),\n            外貌特质: z.string(),\n            衣物装饰: z.string(),\n            装备: z.record(z.string(), DestinedEquipmentSchema),\n            属性: BaseAttributeSchema,\n            登神长阶: AscensionSchema,\n            是否缔结契约: z.boolean().prefault(false),\n            好感度: clampedNum(0, -100, 100),\n            评价: z.string(),\n            背景故事: z.string(),\n            技能: z.record(z.string(), SkillSchema),\n        })),\n    }),\n    新闻: z.object({\n        阿斯塔利亚快讯: z.object({\n            势力要闻: z.string(),\n            尊位行迹: z.string(),\n            军事行动: z.string(),\n            经济动脉: z.string(),\n            灾害预警: z.string(),\n        }),\n        酒馆留言板: z.object({\n            高额悬赏: z.string(),\n            冒险发现: z.string(),\n            怪物异动: z.string(),\n            通缉要犯: z.string(),\n            宝物传闻: z.string(),\n        }),\n        午后茶会: z.object({\n            社交逸闻: z.string(),\n            千里远望: z.string(),\n            命运涟漪: z.string(),\n            邂逅预兆: z.string(),\n        }),\n    }),\n});\n","import { registerMvuSchema } from 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';\n\nimport { Schema } from './schema.ts';\n\n$(() => {\n  registerMvuSchema(Schema);\n});\n"],"names":["z","clampedNum","defaultVal","min","max","coerce","number","prefault","transform","val","_","clamp","BaseItemSchema","object","string","SkillSchema","extend","EquipmentSchema","DestinedEquipmentSchema","InventoryItemSchema","BaseAttributeSchema","CharacterAttributeSchema","DivineRealmSchema","AscensionSchema","boolean","record","QuestSchema","Schema","array","data","Math","floor","$"],"ignoreList":[],"sourceRoot":""}