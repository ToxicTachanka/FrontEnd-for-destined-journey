{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/zod_schema/utils.ts","src://tavern_helper_template/src/zod_schema/schema.ts","src://tavern_helper_template/src/zod_schema/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","/** 数值范围限制 */\nexport const clamp = (min, max) => (val) => _.clamp(val, min, max);\n/**\n * 范围限制数值 schema\n */\nexport const clampedNum = (defaultVal, min, max) => z.coerce.number().prefault(defaultVal).transform(clamp(min, max));\n// 基础物品描述 schema\nexport const BaseItemSchema = z.object({\n    品质: z.string(),\n    标签: z.string(),\n    效果: z.string(),\n    描述: z.string(),\n});\n// 技能 schema (扩展基础物品 + 类型/消耗)\nexport const SkillSchema = BaseItemSchema.extend({\n    类型: z.string(),\n    消耗: z.string(),\n}).transform(({ 品质, 类型, 消耗, 标签, 效果, 描述 }) => ({\n    品质,\n    类型,\n    消耗,\n    标签,\n    效果,\n    描述,\n}));\n// 装备 schema (扩展基础物品 + 位置)\nexport const EquipmentSchema = BaseItemSchema.extend({\n    位置: z.string(),\n});\n// 命定之人装备 schema (扩展基础物品 + 类型)\nexport const DestinedEquipmentSchema = BaseItemSchema.extend({\n    类型: z.string(),\n}).transform(({ 品质, 类型, 标签, 效果, 描述 }) => ({\n    品质,\n    类型,\n    标签,\n    效果,\n    描述,\n}));\n// 背包物品 schema (扩展命定装备 + 数量)\nexport const InventoryItemSchema = BaseItemSchema.extend({\n    数量: z.coerce.number().prefault(1),\n    类型: z.string(),\n}).transform(({ 品质, 数量, 类型, 标签, 效果, 描述 }) => ({\n    品质,\n    数量,\n    类型,\n    标签,\n    效果,\n    描述,\n}));\n// 基础属性 schema\nexport const BaseAttributeSchema = z.object({\n    力量: z.coerce.number(),\n    敏捷: z.coerce.number(),\n    体质: z.coerce.number(),\n    智力: z.coerce.number(),\n    精神: z.coerce.number(),\n});\n// 角色属性 schema (扩展基础属性 + 属性点)\nexport const CharacterAttributeSchema = BaseAttributeSchema.extend({\n    属性点: z.coerce.number(),\n});\n// 神国 schema\nexport const DivineRealmSchema = z.object({\n    名称: z.string(),\n    描述: z.string(),\n});\n// 登神长阶 schema\nexport const AscensionSchema = z.object({\n    是否开启: z.boolean().prefault(false),\n    要素: z.record(z.string(), z.string()),\n    权能: z.record(z.string(), z.string()),\n    法则: z.record(z.string(), z.string()),\n    神位: z.string(),\n    神国: DivineRealmSchema,\n});\n// 任务 schema\nexport const QuestSchema = z.object({\n    简介: z.string(),\n    目标: z.string(),\n    奖励: z.string(),\n});\n","import { AscensionSchema, BaseAttributeSchema, CharacterAttributeSchema, clampedNum, DestinedEquipmentSchema, EquipmentSchema, InventoryItemSchema, QuestSchema, SkillSchema, } from './utils.ts';\nexport const Schema = z.object({\n    世界: z.object({ 时间: z.string(), 地点: z.string() }),\n    事件链: z\n        .any()\n        .prefault({})\n        .transform(() => ({\n        开启: z.boolean().prefault(false),\n        结束: z.boolean().prefault(false),\n        琥珀事件: z.boolean().prefault(false),\n        标题: z.string(),\n        阶段: z.string(),\n        已完成事件: z.array(z.string()),\n    })),\n    任务列表: z.record(z.string(), QuestSchema),\n    角色: z\n        .object({\n        种族: z.string(),\n        身份: z.array(z.string()),\n        职业: z.array(z.string()),\n        生命层级: z.string().prefault('第一层级/普通层级'),\n        等级: z.coerce.number().prefault(1),\n        累计经验值: z.coerce.number(),\n        升级所需经验: z.coerce.number().prefault(15),\n        冒险者等级: z.string().prefault('未评级'),\n        生命值上限: z.coerce.number(),\n        生命值: z.coerce.number(),\n        法力值上限: z.coerce.number(),\n        法力值: z.coerce.number(),\n        体力值上限: z.coerce.number(),\n        体力值: z.coerce.number(),\n        属性: CharacterAttributeSchema,\n        技能列表: z.record(z.string(), SkillSchema),\n    })\n        .transform(data => ({\n        ...data,\n        生命值: _.clamp(data.生命值, 0, data.生命值上限),\n        法力值: _.clamp(data.法力值, 0, data.法力值上限),\n        体力值: _.clamp(data.体力值, 0, data.体力值上限),\n    })),\n    背包: z.record(z.string(), InventoryItemSchema),\n    货币: z.object({\n        金币: z.coerce.number().prefault(0),\n        银币: z.coerce.number().prefault(0),\n        铜币: z.coerce.number().prefault(0),\n    }),\n    装备: z.object({\n        武器: z.record(z.string(), EquipmentSchema),\n        防具: z.record(z.string(), EquipmentSchema),\n        饰品: z.record(z.string(), EquipmentSchema),\n    }),\n    登神长阶: AscensionSchema,\n    命定系统: z.object({\n        命运点数: z.coerce.number().transform(val => Math.floor(Math.max(val, 0))),\n        命定之人: z.record(z.string(), z.object({\n            是否在场: z.boolean().prefault(true),\n            生命层级: z.string(),\n            等级: z.coerce.number().prefault(1),\n            种族: z.string(),\n            身份: z.array(z.string()),\n            职业: z.array(z.string()),\n            性格: z.string(),\n            喜爱: z.string(),\n            外貌特质: z.string(),\n            衣物装饰: z.string(),\n            装备: z.record(z.string(), DestinedEquipmentSchema),\n            属性: BaseAttributeSchema,\n            登神长阶: AscensionSchema,\n            是否缔结契约: z.boolean().prefault(false),\n            好感度: clampedNum(0, -100, 100),\n            评价: z.string(),\n            背景故事: z.string(),\n            技能: z.record(z.string(), SkillSchema),\n        })),\n    }),\n    新闻: z.object({\n        阿斯塔利亚快讯: z.object({\n            势力要闻: z.string(),\n            尊位行迹: z.string(),\n            军事行动: z.string(),\n            经济动脉: z.string(),\n            灾害预警: z.string(),\n        }),\n        酒馆留言板: z.object({\n            高额悬赏: z.string(),\n            冒险发现: z.string(),\n            怪物异动: z.string(),\n            通缉要犯: z.string(),\n            宝物传闻: z.string(),\n        }),\n        午后茶会: z.object({\n            社交逸闻: z.string(),\n            千里远望: z.string(),\n            命运涟漪: z.string(),\n            邂逅预兆: z.string(),\n        }),\n    }),\n});\n","import { registerMvuSchema } from 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';\n\nimport { Schema } from './schema.ts';\n\n$(() => {\n  registerMvuSchema(Schema);\n});\n"],"names":["z","BaseItemSchema","object","string","SkillSchema","extend","transform","EquipmentSchema","DestinedEquipmentSchema","InventoryItemSchema","coerce","number","prefault","BaseAttributeSchema","CharacterAttributeSchema","DivineRealmSchema","AscensionSchema","boolean","record","QuestSchema","Schema","any","array","data","_","clamp","val","Math","floor","max","defaultVal","min","$"],"ignoreList":[],"sourceRoot":""}